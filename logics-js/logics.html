<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script type="module" src="logics.js"></script>
</head>
<body>
    <textarea id="prompt" placeholder="Logics"></textarea>
    <ul id="result"></ul>

    <script>
        let values = {
            "name": "Doe",
            "firstname": "John",
            "person": {
                "firstname": "Bernd",
                "name": "Bommelunder"
            },
            "tic_p_med__1_type": "Aspirine",
            "tic_p_med__1_frequ": "5",
            "tic_p_med__1_dose": "27.5",
            "tic_p_med__1_days": "100",
            "tic_p_med__2_type": "Taurin",
            "tic_p_med__2_frequ": "5",
            "tic_p_med__2_dose": "27",
            "tic_p_med__2_days": "0",
            "tic_p_med__3_type": "",
            "tic_p_med__3_frequ": "0",
            "tic_p_med__3_dose": "-27",
            "tic_p_med__3_days": "2",
            "roles": ["custom"],
        };

        document.querySelector("#prompt").addEventListener(
            "change",
            (e) => {
                let calc;

                let li = document.createElement("li");
                document.querySelector("#result").appendChild(li);
                li.appendChild(document.createTextNode(e.target.value + " = "));

                console.debug("values = ", values);

                try {
                    calc = new logics.Logics(e.target.value);

                    let result = calc.run(values);
                    console.debug("result = ", result);

                    li.appendChild(document.createTextNode(result.repr()));
                }
                catch (exception) {
                    console.log(exception);
                    li.style.color = "red";
                    li.appendChild(document.createTextNode(exception.toString()));
                }

            }
        )
    </script>
</body>
</html>
